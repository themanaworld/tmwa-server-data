// Mining Nodes
// Author: wushin
// NodeManager
030-1.gat,0,0,0|script|#NodeManager47|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFortysevenSpawned, "", getarraysize($@NodesFortysevenSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFortysevenNodeLoop, 0;
    set $@RandomFortysevenNode, rand(getarraysize($@NodeManagerFortysevenSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFortysevenNode == $@NodesFortysevenSpawned[$@RandomFortysevenNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFortysevenNodeLoop, ($@RandomFortysevenNodeLoop + 1);
    if ($@RandomFortysevenNodeLoop >= getarraysize($@NodesFortysevenSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFortysevenSpawn[$@RandomFortysevenNode];
    setarray $@NodesFortysevenSpawned[$@NodeManagerFortysevenSpawnCount], $@RandomFortysevenNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFortysevenSpawnCount, ($@NodeManagerFortysevenSpawnCount + 1);
    if ($@NodeManagerFortysevenSpawnMax > $@NodeManagerFortysevenSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFortysevenNodeLoop, 0;
    set $@RandomFortysevenNode, rand(getarraysize($@NodeManagerFortysevenSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFortysevenNode == $@NodesFortysevenSpawned[$@RandomFortysevenNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFortysevenNodeLoop, ($@RandomFortysevenNodeLoop + 1);
    if ($@RandomFortysevenNodeLoop >= getarraysize($@NodesFortysevenSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFortysevenSpawn[$@RandomFortysevenNode];
    setarray $@NodesFortysevenSpawned[$@DisableFortysevenSpawnsLoop], $@RandomFortysevenNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFortysevenSpawnsLoop, ($@DisableFortysevenSpawnsLoop + 1);
    if ($@NodeManagerFortysevenSpawnMax > $@DisableFortysevenSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFortysevenSpawnCount, ($@NodeManagerFortysevenSpawnCount - 1);
    if ($@NodeManagerFortysevenSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFortysevenSpawnsLoop, 0;
    set $@NodeManagerFortysevenSpawnMax, 3;
    set $@NodeManagerFortysevenSpawnCount, 3;
    setarray $@NodeManagerFortysevenSpawn, 297, 298, 299, 300, 301, 302;
    cleararray $@NodesFortysevenSpawned, "", getarraysize($@NodesFortysevenSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
030-1.gat,109,35,0|script|#Node297|609,
{
    set @NodeId, 297;
    set @NodeManagerId, 47;
    setarray @npc_loc, 109, 35, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
030-1.gat,109,45,0|script|#Node298|609,
{
    set @NodeId, 298;
    set @NodeManagerId, 47;
    setarray @npc_loc, 109, 45, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
030-1.gat,108,57,0|script|#Node299|609,
{
    set @NodeId, 299;
    set @NodeManagerId, 47;
    setarray @npc_loc, 108, 57, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
030-1.gat,99,60,0|script|#Node300|609,
{
    set @NodeId, 300;
    set @NodeManagerId, 47;
    setarray @npc_loc, 99, 60, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
030-1.gat,89,61,0|script|#Node301|609,
{
    set @NodeId, 301;
    set @NodeManagerId, 47;
    setarray @npc_loc, 89, 61, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
030-1.gat,79,68,0|script|#Node302|609,
{
    set @NodeId, 302;
    set @NodeManagerId, 47;
    setarray @npc_loc, 79, 68, 2;
    callfunc "IceCube";
    end;
}
// NodeManager
030-1.gat,0,0,0|script|#NodeManager48|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFortyeightSpawned, "", getarraysize($@NodesFortyeightSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFortyeightNodeLoop, 0;
    set $@RandomFortyeightNode, rand(getarraysize($@NodeManagerFortyeightSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFortyeightNode == $@NodesFortyeightSpawned[$@RandomFortyeightNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFortyeightNodeLoop, ($@RandomFortyeightNodeLoop + 1);
    if ($@RandomFortyeightNodeLoop >= getarraysize($@NodesFortyeightSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFortyeightSpawn[$@RandomFortyeightNode];
    setarray $@NodesFortyeightSpawned[$@NodeManagerFortyeightSpawnCount], $@RandomFortyeightNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFortyeightSpawnCount, ($@NodeManagerFortyeightSpawnCount + 1);
    if ($@NodeManagerFortyeightSpawnMax > $@NodeManagerFortyeightSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFortyeightNodeLoop, 0;
    set $@RandomFortyeightNode, rand(getarraysize($@NodeManagerFortyeightSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFortyeightNode == $@NodesFortyeightSpawned[$@RandomFortyeightNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFortyeightNodeLoop, ($@RandomFortyeightNodeLoop + 1);
    if ($@RandomFortyeightNodeLoop >= getarraysize($@NodesFortyeightSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFortyeightSpawn[$@RandomFortyeightNode];
    setarray $@NodesFortyeightSpawned[$@DisableFortyeightSpawnsLoop], $@RandomFortyeightNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFortyeightSpawnsLoop, ($@DisableFortyeightSpawnsLoop + 1);
    if ($@NodeManagerFortyeightSpawnMax > $@DisableFortyeightSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFortyeightSpawnCount, ($@NodeManagerFortyeightSpawnCount - 1);
    if ($@NodeManagerFortyeightSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFortyeightSpawnsLoop, 0;
    set $@NodeManagerFortyeightSpawnMax, 3;
    set $@NodeManagerFortyeightSpawnCount, 3;
    setarray $@NodeManagerFortyeightSpawn, 303, 304, 305, 306, 307, 308;
    cleararray $@NodesFortyeightSpawned, "", getarraysize($@NodesFortyeightSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
030-1.gat,65,34,0|script|#Node303|602,
{
    set @NodeId, 303;
    set @NodeManagerId, 48;
    setarray @npc_loc, 65, 34, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
030-1.gat,68,82,0|script|#Node304|602,
{
    set @NodeId, 304;
    set @NodeManagerId, 48;
    setarray @npc_loc, 68, 82, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
030-1.gat,50,80,0|script|#Node305|602,
{
    set @NodeId, 305;
    set @NodeManagerId, 48;
    setarray @npc_loc, 50, 80, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
030-1.gat,57,53,0|script|#Node306|602,
{
    set @NodeId, 306;
    set @NodeManagerId, 48;
    setarray @npc_loc, 57, 53, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
030-1.gat,91,52,0|script|#Node307|602,
{
    set @NodeId, 307;
    set @NodeManagerId, 48;
    setarray @npc_loc, 91, 52, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
030-1.gat,50,61,0|script|#Node308|602,
{
    set @NodeId, 308;
    set @NodeManagerId, 48;
    setarray @npc_loc, 50, 61, 2;
    callfunc "CobaltPlant";
    end;
}
