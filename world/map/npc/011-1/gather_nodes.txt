// Mining Nodes
// Author: wushin
// NodeManager
011-1.gat,0,0,0|script|#NodeManager26|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesTwentysixSpawned, "", getarraysize($@NodesTwentysixSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomTwentysixNodeLoop, 0;
    set $@RandomTwentysixNode, rand(getarraysize($@NodeManagerTwentysixSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomTwentysixNode == $@NodesTwentysixSpawned[$@RandomTwentysixNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomTwentysixNodeLoop, ($@RandomTwentysixNodeLoop + 1);
    if ($@RandomTwentysixNodeLoop >= getarraysize($@NodesTwentysixSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerTwentysixSpawn[$@RandomTwentysixNode];
    setarray $@NodesTwentysixSpawned[$@NodeManagerTwentysixSpawnCount], $@RandomTwentysixNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerTwentysixSpawnCount, ($@NodeManagerTwentysixSpawnCount + 1);
    if ($@NodeManagerTwentysixSpawnMax > $@NodeManagerTwentysixSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomTwentysixNodeLoop, 0;
    set $@RandomTwentysixNode, rand(getarraysize($@NodeManagerTwentysixSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomTwentysixNode == $@NodesTwentysixSpawned[$@RandomTwentysixNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomTwentysixNodeLoop, ($@RandomTwentysixNodeLoop + 1);
    if ($@RandomTwentysixNodeLoop >= getarraysize($@NodesTwentysixSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerTwentysixSpawn[$@RandomTwentysixNode];
    setarray $@NodesTwentysixSpawned[$@DisableTwentysixSpawnsLoop], $@RandomTwentysixNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableTwentysixSpawnsLoop, ($@DisableTwentysixSpawnsLoop + 1);
    if ($@NodeManagerTwentysixSpawnMax > $@DisableTwentysixSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerTwentysixSpawnCount, ($@NodeManagerTwentysixSpawnCount - 1);
    if ($@NodeManagerTwentysixSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableTwentysixSpawnsLoop, 0;
    set $@NodeManagerTwentysixSpawnMax, 3;
    set $@NodeManagerTwentysixSpawnCount, 3;
    setarray $@NodeManagerTwentysixSpawn, 151, 152, 153, 154, 155, 156;
    cleararray $@NodesTwentysixSpawned, "", getarraysize($@NodesTwentysixSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
011-1.gat,121,79,0|script|#Node151|601,
{
    set @NodeId, 151;
    set @NodeManagerId, 26;
    setarray @npc_loc, 121, 79, 2;
    callfunc "MauvePlant";
    end;
}
// Gather Node NPC
011-1.gat,38,79,0|script|#Node152|601,
{
    set @NodeId, 152;
    set @NodeManagerId, 26;
    setarray @npc_loc, 38, 79, 2;
    callfunc "MauvePlant";
    end;
}
// Gather Node NPC
011-1.gat,32,31,0|script|#Node153|601,
{
    set @NodeId, 153;
    set @NodeManagerId, 26;
    setarray @npc_loc, 32, 31, 2;
    callfunc "MauvePlant";
    end;
}
// Gather Node NPC
011-1.gat,100,34,0|script|#Node154|601,
{
    set @NodeId, 154;
    set @NodeManagerId, 26;
    setarray @npc_loc, 100, 34, 2;
    callfunc "MauvePlant";
    end;
}
// Gather Node NPC
011-1.gat,64,31,0|script|#Node155|601,
{
    set @NodeId, 155;
    set @NodeManagerId, 26;
    setarray @npc_loc, 64, 31, 2;
    callfunc "MauvePlant";
    end;
}
// Gather Node NPC
011-1.gat,90,74,0|script|#Node156|601,
{
    set @NodeId, 156;
    set @NodeManagerId, 26;
    setarray @npc_loc, 90, 74, 2;
    callfunc "MauvePlant";
    end;
}
