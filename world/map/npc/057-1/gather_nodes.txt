// Mining Nodes
// Author: wushin

// NodeManager
057-1.gat,0,0,0|script|#NodeManager44|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFortyfourSpawned, "", getarraysize($@NodesFortyfourSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFortyfourNodeLoop, 0;
    set $@RandomFortyfourNode, rand(getarraysize($@NodeManagerFortyfourSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFortyfourNode == $@NodesFortyfourSpawned[$@RandomFortyfourNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFortyfourNodeLoop, ($@RandomFortyfourNodeLoop + 1);
    if ($@RandomFortyfourNodeLoop >= getarraysize($@NodesFortyfourSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFortyfourSpawn[$@RandomFortyfourNode];
    setarray $@NodesFortyfourSpawned[$@NodeManagerFortyfourSpawnCount], $@RandomFortyfourNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFortyfourSpawnCount, ($@NodeManagerFortyfourSpawnCount + 1);
    if ($@NodeManagerFortyfourSpawnMax > $@NodeManagerFortyfourSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFortyfourNodeLoop, 0;
    set $@RandomFortyfourNode, rand(getarraysize($@NodeManagerFortyfourSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFortyfourNode == $@NodesFortyfourSpawned[$@RandomFortyfourNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFortyfourNodeLoop, ($@RandomFortyfourNodeLoop + 1);
    if ($@RandomFortyfourNodeLoop >= getarraysize($@NodesFortyfourSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFortyfourSpawn[$@RandomFortyfourNode];
    setarray $@NodesFortyfourSpawned[$@DisableFortyfourSpawnsLoop], $@RandomFortyfourNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFortyfourSpawnsLoop, ($@DisableFortyfourSpawnsLoop + 1);
    if ($@NodeManagerFortyfourSpawnMax > $@DisableFortyfourSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFortyfourSpawnCount, ($@NodeManagerFortyfourSpawnCount - 1);
    if ($@NodeManagerFortyfourSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFortyfourSpawnsLoop, 0;
    set $@NodeManagerFortyfourSpawnMax, 6;
    set $@NodeManagerFortyfourSpawnCount, 6;
    setarray $@NodeManagerFortyfourSpawn, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284;
    cleararray $@NodesFortyfourSpawned, "", getarraysize($@NodesFortyfourSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// Gather Node NPC
057-1.gat,30,46,0|script|#Node273|601,
{
    set @NodeId, 273;
    set @NodeManagerId, 44;
    setarray @npc_loc, 30, 46, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
057-1.gat,59,32,0|script|#Node274|601,
{
    set @NodeId, 274;
    set @NodeManagerId, 44;
    setarray @npc_loc, 59, 32, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
057-1.gat,83,66,0|script|#Node275|601,
{
    set @NodeId, 275;
    set @NodeManagerId, 44;
    setarray @npc_loc, 83, 66, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
057-1.gat,105,29,0|script|#Node276|603,
{
    set @NodeId, 276;
    set @NodeManagerId, 44;
    setarray @npc_loc, 105, 29, 2;
    callfunc "GambrogePlant";
    end;
}

// Gather Node NPC
057-1.gat,97,81,0|script|#Node277|601,
{
    set @NodeId, 277;
    set @NodeManagerId, 44;
    setarray @npc_loc, 97, 81, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
057-1.gat,125,68,0|script|#Node278|601,
{
    set @NodeId, 278;
    set @NodeManagerId, 44;
    setarray @npc_loc, 125, 68, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
057-1.gat,135,53,0|script|#Node279|603,
{
    set @NodeId, 279;
    set @NodeManagerId, 44;
    setarray @npc_loc, 135, 53, 2;
    callfunc "GambrogePlant";
    end;
}

// Gather Node NPC
057-1.gat,144,35,0|script|#Node280|605,
{
    set @NodeId, 280;
    set @NodeManagerId, 44;
    setarray @npc_loc, 144, 35, 2;
    callfunc "CloverPatch";
    end;
}

// Gather Node NPC
057-1.gat,144,74,0|script|#Node281|601,
{
    set @NodeId, 281;
    set @NodeManagerId, 44;
    setarray @npc_loc, 144, 74, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
057-1.gat,120,54,0|script|#Node282|601,
{
    set @NodeId, 282;
    set @NodeManagerId, 44;
    setarray @npc_loc, 120, 54, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
057-1.gat,75,30,0|script|#Node283|605,
{
    set @NodeId, 283;
    set @NodeManagerId, 44;
    setarray @npc_loc, 75, 30, 2;
    callfunc "CloverPatch";
    end;
}

// Gather Node NPC
057-1.gat,36,69,0|script|#Node284|603,
{
    set @NodeId, 284;
    set @NodeManagerId, 44;
    setarray @npc_loc, 36, 69, 2;
    callfunc "GambrogePlant";
    end;
}
// NodeManager
057-1.gat,0,0,0|script|#NodeManager62|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesSixtytwoSpawned, "", getarraysize($@NodesSixtytwoSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomSixtytwoNodeLoop, 0;
    set $@RandomSixtytwoNode, rand(getarraysize($@NodeManagerSixtytwoSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomSixtytwoNode == $@NodesSixtytwoSpawned[$@RandomSixtytwoNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomSixtytwoNodeLoop, ($@RandomSixtytwoNodeLoop + 1);
    if ($@RandomSixtytwoNodeLoop >= getarraysize($@NodesSixtytwoSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerSixtytwoSpawn[$@RandomSixtytwoNode];
    setarray $@NodesSixtytwoSpawned[$@NodeManagerSixtytwoSpawnCount], $@RandomSixtytwoNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerSixtytwoSpawnCount, ($@NodeManagerSixtytwoSpawnCount + 1);
    if ($@NodeManagerSixtytwoSpawnMax > $@NodeManagerSixtytwoSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomSixtytwoNodeLoop, 0;
    set $@RandomSixtytwoNode, rand(getarraysize($@NodeManagerSixtytwoSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomSixtytwoNode == $@NodesSixtytwoSpawned[$@RandomSixtytwoNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomSixtytwoNodeLoop, ($@RandomSixtytwoNodeLoop + 1);
    if ($@RandomSixtytwoNodeLoop >= getarraysize($@NodesSixtytwoSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerSixtytwoSpawn[$@RandomSixtytwoNode];
    setarray $@NodesSixtytwoSpawned[$@DisableSixtytwoSpawnsLoop], $@RandomSixtytwoNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableSixtytwoSpawnsLoop, ($@DisableSixtytwoSpawnsLoop + 1);
    if ($@NodeManagerSixtytwoSpawnMax > $@DisableSixtytwoSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerSixtytwoSpawnCount, ($@NodeManagerSixtytwoSpawnCount - 1);
    if ($@NodeManagerSixtytwoSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableSixtytwoSpawnsLoop, 0;
    set $@NodeManagerSixtytwoSpawnMax, 3;
    set $@NodeManagerSixtytwoSpawnCount, 3;
    setarray $@NodeManagerSixtytwoSpawn, 405, 406, 407, 408, 409, 410;
    cleararray $@NodesSixtytwoSpawned, "", getarraysize($@NodesSixtytwoSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
057-1.gat,55,31,0|script|#Node405|610,
{
    set @NodeId, 405;
    set @NodeManagerId, 62;
    setarray @npc_loc, 55, 31, 2;
    callfunc "Beehive";
    end;
}
// Gather Node NPC
057-1.gat,107,41,0|script|#Node406|610,
{
    set @NodeId, 406;
    set @NodeManagerId, 62;
    setarray @npc_loc, 107, 41, 2;
    callfunc "Beehive";
    end;
}
// Gather Node NPC
057-1.gat,146,32,0|script|#Node407|610,
{
    set @NodeId, 407;
    set @NodeManagerId, 62;
    setarray @npc_loc, 146, 32, 2;
    callfunc "Beehive";
    end;
}
// Gather Node NPC
057-1.gat,124,75,0|script|#Node408|610,
{
    set @NodeId, 408;
    set @NodeManagerId, 62;
    setarray @npc_loc, 124, 75, 2;
    callfunc "Beehive";
    end;
}
// Gather Node NPC
057-1.gat,32,66,0|script|#Node409|610,
{
    set @NodeId, 409;
    set @NodeManagerId, 62;
    setarray @npc_loc, 32, 66, 2;
    callfunc "Beehive";
    end;
}
// Gather Node NPC
057-1.gat,29,31,0|script|#Node410|610,
{
    set @NodeId, 410;
    set @NodeManagerId, 62;
    setarray @npc_loc, 29, 31, 2;
    callfunc "Beehive";
    end;
}
