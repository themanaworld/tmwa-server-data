// Mining Nodes
// Author: wushin

// NodeManager
018-3.gat,0,0,0|script|#NodeManager12|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesTwelveSpawned, "", getarraysize($@NodesTwelveSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomTwelveNodeLoop, 0;
    set $@RandomTwelveNode, rand(getarraysize($@NodeManagerTwelveSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomTwelveNode == $@NodesTwelveSpawned[$@RandomTwelveNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomTwelveNodeLoop, ($@RandomTwelveNodeLoop + 1);
    if ($@RandomTwelveNodeLoop >= getarraysize($@NodesTwelveSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerTwelveSpawn[$@RandomTwelveNode];
    setarray $@NodesTwelveSpawned[$@NodeManagerTwelveSpawnCount], $@RandomTwelveNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerTwelveSpawnCount, ($@NodeManagerTwelveSpawnCount + 1);
    if ($@NodeManagerTwelveSpawnMax > $@NodeManagerTwelveSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomTwelveNodeLoop, 0;
    set $@RandomTwelveNode, rand(getarraysize($@NodeManagerTwelveSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomTwelveNode == $@NodesTwelveSpawned[$@RandomTwelveNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomTwelveNodeLoop, ($@RandomTwelveNodeLoop + 1);
    if ($@RandomTwelveNodeLoop >= getarraysize($@NodesTwelveSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerTwelveSpawn[$@RandomTwelveNode];
    setarray $@NodesTwelveSpawned[$@DisableTwelveSpawnsLoop], $@RandomTwelveNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableTwelveSpawnsLoop, ($@DisableTwelveSpawnsLoop + 1);
    if ($@NodeManagerTwelveSpawnMax > $@DisableTwelveSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerTwelveSpawnCount, ($@NodeManagerTwelveSpawnCount - 1);
    if ($@NodeManagerTwelveSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableTwelveSpawnsLoop, 0;
    set $@NodeManagerTwelveSpawnMax, 3;
    set $@NodeManagerTwelveSpawnCount, 3;
    setarray $@NodeManagerTwelveSpawn, 67, 68, 69, 70, 71, 72;
    cleararray $@NodesTwelveSpawned, "", getarraysize($@NodesTwelveSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// NodeManager
018-3.gat,0,0,0|script|#NodeManager13|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesThriteenSpawned, "", getarraysize($@NodesThriteenSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomThriteenNodeLoop, 0;
    set $@RandomThriteenNode, rand(getarraysize($@NodeManagerThriteenSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomThriteenNode == $@NodesThriteenSpawned[$@RandomThriteenNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomThriteenNodeLoop, ($@RandomThriteenNodeLoop + 1);
    if ($@RandomThriteenNodeLoop >= getarraysize($@NodesThriteenSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerThriteenSpawn[$@RandomThriteenNode];
    setarray $@NodesThriteenSpawned[$@NodeManagerThriteenSpawnCount], $@RandomThriteenNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerThriteenSpawnCount, ($@NodeManagerThriteenSpawnCount + 1);
    if ($@NodeManagerThriteenSpawnMax > $@NodeManagerThriteenSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomThriteenNodeLoop, 0;
    set $@RandomThriteenNode, rand(getarraysize($@NodeManagerThriteenSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomThriteenNode == $@NodesThriteenSpawned[$@RandomThriteenNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomThriteenNodeLoop, ($@RandomThriteenNodeLoop + 1);
    if ($@RandomThriteenNodeLoop >= getarraysize($@NodesThriteenSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerThriteenSpawn[$@RandomThriteenNode];
    setarray $@NodesThriteenSpawned[$@DisableThriteenSpawnsLoop], $@RandomThriteenNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableThriteenSpawnsLoop, ($@DisableThriteenSpawnsLoop + 1);
    if ($@NodeManagerThriteenSpawnMax > $@DisableThriteenSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerThriteenSpawnCount, ($@NodeManagerThriteenSpawnCount - 1);
    if ($@NodeManagerThriteenSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableThriteenSpawnsLoop, 0;
    set $@NodeManagerThriteenSpawnMax, 3;
    set $@NodeManagerThriteenSpawnCount, 3;
    setarray $@NodeManagerThriteenSpawn, 73, 74, 75, 76, 77, 78;
    cleararray $@NodesThriteenSpawned, "", getarraysize($@NodesThriteenSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// Gather Node NPC
018-3.gat,162,168,0|script|#Node67|501,
{
    set @NodeId, 67;
    set @NodeManagerId, 12;
    setarray @npc_loc, 162, 168, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
018-3.gat,137,140,0|script|#Node68|501,
{
    set @NodeId, 68;
    set @NodeManagerId, 12;
    setarray @npc_loc, 137, 140, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
018-3.gat,20,146,0|script|#Node69|501,
{
    set @NodeId, 69;
    set @NodeManagerId, 12;
    setarray @npc_loc, 20, 146, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
018-3.gat,157,21,0|script|#Node70|501,
{
    set @NodeId, 70;
    set @NodeManagerId, 12;
    setarray @npc_loc, 157, 21, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
018-3.gat,20,59,0|script|#Node71|501,
{
    set @NodeId, 71;
    set @NodeManagerId, 12;
    setarray @npc_loc, 20, 59, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
018-3.gat,178,87,0|script|#Node72|501,
{
    set @NodeId, 72;
    set @NodeManagerId, 12;
    setarray @npc_loc, 178, 87, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
018-3.gat,132,36,0|script|#Node73|502,
{
    set @NodeId, 73;
    set @NodeManagerId, 13;
    setarray @npc_loc, 132, 36, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
018-3.gat,101,38,0|script|#Node74|502,
{
    set @NodeId, 74;
    set @NodeManagerId, 13;
    setarray @npc_loc, 101, 38, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
018-3.gat,54,99,0|script|#Node75|502,
{
    set @NodeId, 75;
    set @NodeManagerId, 13;
    setarray @npc_loc, 54, 99, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
018-3.gat,83,174,0|script|#Node76|502,
{
    set @NodeId, 76;
    set @NodeManagerId, 13;
    setarray @npc_loc, 83, 174, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
018-3.gat,100,53,0|script|#Node77|502,
{
    set @NodeId, 77;
    set @NodeManagerId, 13;
    setarray @npc_loc, 100, 53, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
018-3.gat,166,104,0|script|#Node78|502,
{
    set @NodeId, 78;
    set @NodeManagerId, 13;
    setarray @npc_loc, 166, 104, 2;
    callfunc "IronVein";
    end;
}
