// Mining Nodes
// Author: wushin
// NodeManager
034-1.gat,0,0,0|script|#NodeManager53|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFiftythreeSpawned, "", getarraysize($@NodesFiftythreeSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFiftythreeNodeLoop, 0;
    set $@RandomFiftythreeNode, rand(getarraysize($@NodeManagerFiftythreeSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFiftythreeNode == $@NodesFiftythreeSpawned[$@RandomFiftythreeNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFiftythreeNodeLoop, ($@RandomFiftythreeNodeLoop + 1);
    if ($@RandomFiftythreeNodeLoop >= getarraysize($@NodesFiftythreeSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFiftythreeSpawn[$@RandomFiftythreeNode];
    setarray $@NodesFiftythreeSpawned[$@NodeManagerFiftythreeSpawnCount], $@RandomFiftythreeNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFiftythreeSpawnCount, ($@NodeManagerFiftythreeSpawnCount + 1);
    if ($@NodeManagerFiftythreeSpawnMax > $@NodeManagerFiftythreeSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFiftythreeNodeLoop, 0;
    set $@RandomFiftythreeNode, rand(getarraysize($@NodeManagerFiftythreeSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFiftythreeNode == $@NodesFiftythreeSpawned[$@RandomFiftythreeNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFiftythreeNodeLoop, ($@RandomFiftythreeNodeLoop + 1);
    if ($@RandomFiftythreeNodeLoop >= getarraysize($@NodesFiftythreeSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFiftythreeSpawn[$@RandomFiftythreeNode];
    setarray $@NodesFiftythreeSpawned[$@DisableFiftythreeSpawnsLoop], $@RandomFiftythreeNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFiftythreeSpawnsLoop, ($@DisableFiftythreeSpawnsLoop + 1);
    if ($@NodeManagerFiftythreeSpawnMax > $@DisableFiftythreeSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFiftythreeSpawnCount, ($@NodeManagerFiftythreeSpawnCount - 1);
    if ($@NodeManagerFiftythreeSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFiftythreeSpawnsLoop, 0;
    set $@NodeManagerFiftythreeSpawnMax, 3;
    set $@NodeManagerFiftythreeSpawnCount, 3;
    setarray $@NodeManagerFiftythreeSpawn, 333, 334, 335, 336, 337, 338;
    cleararray $@NodesFiftythreeSpawned, "", getarraysize($@NodesFiftythreeSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
034-1.gat,60,97,0|script|#Node333|602,
{
    set @NodeId, 333;
    set @NodeManagerId, 53;
    setarray @npc_loc, 60, 97, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,67,94,0|script|#Node334|602,
{
    set @NodeId, 334;
    set @NodeManagerId, 53;
    setarray @npc_loc, 67, 94, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,22,66,0|script|#Node335|602,
{
    set @NodeId, 335;
    set @NodeManagerId, 53;
    setarray @npc_loc, 22, 66, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,36,59,0|script|#Node336|602,
{
    set @NodeId, 336;
    set @NodeManagerId, 53;
    setarray @npc_loc, 36, 59, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,21,28,0|script|#Node337|602,
{
    set @NodeId, 337;
    set @NodeManagerId, 53;
    setarray @npc_loc, 21, 28, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,20,100,0|script|#Node338|602,
{
    set @NodeId, 338;
    set @NodeManagerId, 53;
    setarray @npc_loc, 20, 100, 2;
    callfunc "CobaltPlant";
    end;
}
// NodeManager
034-1.gat,0,0,0|script|#NodeManager54|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFiftyfourSpawned, "", getarraysize($@NodesFiftyfourSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFiftyfourNodeLoop, 0;
    set $@RandomFiftyfourNode, rand(getarraysize($@NodeManagerFiftyfourSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFiftyfourNode == $@NodesFiftyfourSpawned[$@RandomFiftyfourNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFiftyfourNodeLoop, ($@RandomFiftyfourNodeLoop + 1);
    if ($@RandomFiftyfourNodeLoop >= getarraysize($@NodesFiftyfourSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFiftyfourSpawn[$@RandomFiftyfourNode];
    setarray $@NodesFiftyfourSpawned[$@NodeManagerFiftyfourSpawnCount], $@RandomFiftyfourNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFiftyfourSpawnCount, ($@NodeManagerFiftyfourSpawnCount + 1);
    if ($@NodeManagerFiftyfourSpawnMax > $@NodeManagerFiftyfourSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFiftyfourNodeLoop, 0;
    set $@RandomFiftyfourNode, rand(getarraysize($@NodeManagerFiftyfourSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFiftyfourNode == $@NodesFiftyfourSpawned[$@RandomFiftyfourNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFiftyfourNodeLoop, ($@RandomFiftyfourNodeLoop + 1);
    if ($@RandomFiftyfourNodeLoop >= getarraysize($@NodesFiftyfourSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFiftyfourSpawn[$@RandomFiftyfourNode];
    setarray $@NodesFiftyfourSpawned[$@DisableFiftyfourSpawnsLoop], $@RandomFiftyfourNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFiftyfourSpawnsLoop, ($@DisableFiftyfourSpawnsLoop + 1);
    if ($@NodeManagerFiftyfourSpawnMax > $@DisableFiftyfourSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFiftyfourSpawnCount, ($@NodeManagerFiftyfourSpawnCount - 1);
    if ($@NodeManagerFiftyfourSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFiftyfourSpawnsLoop, 0;
    set $@NodeManagerFiftyfourSpawnMax, 3;
    set $@NodeManagerFiftyfourSpawnCount, 3;
    setarray $@NodeManagerFiftyfourSpawn, 339, 340, 341, 342, 343, 344;
    cleararray $@NodesFiftyfourSpawned, "", getarraysize($@NodesFiftyfourSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
034-1.gat,32,24,0|script|#Node339|602,
{
    set @NodeId, 339;
    set @NodeManagerId, 54;
    setarray @npc_loc, 32, 24, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,97,21,0|script|#Node340|602,
{
    set @NodeId, 340;
    set @NodeManagerId, 54;
    setarray @npc_loc, 97, 21, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,114,92,0|script|#Node341|602,
{
    set @NodeId, 341;
    set @NodeManagerId, 54;
    setarray @npc_loc, 114, 92, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,88,68,0|script|#Node342|602,
{
    set @NodeId, 342;
    set @NodeManagerId, 54;
    setarray @npc_loc, 88, 68, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,100,33,0|script|#Node343|602,
{
    set @NodeId, 343;
    set @NodeManagerId, 54;
    setarray @npc_loc, 100, 33, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
034-1.gat,55,55,0|script|#Node344|602,
{
    set @NodeId, 344;
    set @NodeManagerId, 54;
    setarray @npc_loc, 55, 55, 2;
    callfunc "CobaltPlant";
    end;
}
