// Mining Nodes
// Author: wushin

// NodeManager
012-4.gat,0,0,0|script|#NodeManager8|400,
{
    end;

OnTimer15000:
    stopnpctimer;
    cleararray $@NodesEightSpawned, "", getarraysize($@NodesEightSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomEightNodeLoop, 0;
    set $@RandomEightNode, rand(getarraysize($@NodeManagerEightSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomEightNode == $@NodesEightSpawned[$@RandomEightNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomEightNodeLoop, ($@RandomEightNodeLoop + 1);
    if ($@RandomEightNodeLoop >= getarraysize($@NodesEightSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerEightSpawn[$@RandomEightNode];
    setarray $@NodesEightSpawned[$@NodeManagerEightSpawnCount], $@RandomEightNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerEightSpawnCount, ($@NodeManagerEightSpawnCount + 1);
    if ($@NodeManagerEightSpawnMax > $@NodeManagerEightSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomEightNodeLoop, 0;
    set $@RandomEightNode, rand(getarraysize($@NodeManagerEightSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomEightNode == $@NodesEightSpawned[$@RandomEightNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomEightNodeLoop, ($@RandomEightNodeLoop + 1);
    if ($@RandomEightNodeLoop >= getarraysize($@NodesEightSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerEightSpawn[$@RandomEightNode];
    setarray $@NodesEightSpawned[$@DisableEightSpawnsLoop], $@RandomEightNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableEightSpawnsLoop, ($@DisableEightSpawnsLoop + 1);
    if ($@NodeManagerEightSpawnMax > $@DisableEightSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerEightSpawnCount, ($@NodeManagerEightSpawnCount - 1);
    if ($@NodeManagerEightSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableEightSpawnsLoop, 0;
    set $@NodeManagerEightSpawnMax, 3;
    set $@NodeManagerEightSpawnCount, 3;
    setarray $@NodeManagerEightSpawn, 43, 44, 45, 46, 47, 48;
    cleararray $@NodesEightSpawned, "", getarraysize($@NodesEightSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// NodeManager
012-4.gat,0,0,0|script|#NodeManager9|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesNineSpawned, "", getarraysize($@NodesNineSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomNineNodeLoop, 0;
    set $@RandomNineNode, rand(getarraysize($@NodeManagerNineSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomNineNode == $@NodesNineSpawned[$@RandomNineNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomNineNodeLoop, ($@RandomNineNodeLoop + 1);
    if ($@RandomNineNodeLoop >= getarraysize($@NodesNineSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerNineSpawn[$@RandomNineNode];
    setarray $@NodesNineSpawned[$@NodeManagerNineSpawnCount], $@RandomNineNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerNineSpawnCount, ($@NodeManagerNineSpawnCount + 1);
    if ($@NodeManagerNineSpawnMax > $@NodeManagerNineSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomNineNodeLoop, 0;
    set $@RandomNineNode, rand(getarraysize($@NodeManagerNineSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomNineNode == $@NodesNineSpawned[$@RandomNineNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomNineNodeLoop, ($@RandomNineNodeLoop + 1);
    if ($@RandomNineNodeLoop >= getarraysize($@NodesNineSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerNineSpawn[$@RandomNineNode];
    setarray $@NodesNineSpawned[$@DisableNineSpawnsLoop], $@RandomNineNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableNineSpawnsLoop, ($@DisableNineSpawnsLoop + 1);
    if ($@NodeManagerNineSpawnMax > $@DisableNineSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerNineSpawnCount, ($@NodeManagerNineSpawnCount - 1);
    if ($@NodeManagerNineSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableNineSpawnsLoop, 0;
    set $@NodeManagerNineSpawnMax, 3;
    set $@NodeManagerNineSpawnCount, 3;
    setarray $@NodeManagerNineSpawn, 49, 50, 51, 52, 53, 54;
    cleararray $@NodesNineSpawned, "", getarraysize($@NodesNineSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// Gather Node NPC
012-4.gat,55,29,0|script|#Node43|503,
{
    set @NodeId, 43;
    set @NodeManagerId, 8;
    setarray @npc_loc, 55, 29, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,37,184,0|script|#Node44|503,
{
    set @NodeId, 44;
    set @NodeManagerId, 8;
    setarray @npc_loc, 37, 184, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,472,114,0|script|#Node45|503,
{
    set @NodeId, 45;
    set @NodeManagerId, 8;
    setarray @npc_loc, 472, 114, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,425,36,0|script|#Node46|503,
{
    set @NodeId, 46;
    set @NodeManagerId, 8;
    setarray @npc_loc, 425, 36, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,131,164,0|script|#Node47|503,
{
    set @NodeId, 47;
    set @NodeManagerId, 8;
    setarray @npc_loc, 131, 164, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,130,43,0|script|#Node48|503,
{
    set @NodeId, 48;
    set @NodeManagerId, 8;
    setarray @npc_loc, 130, 43, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,26,37,0|script|#Node49|503,
{
    set @NodeId, 49;
    set @NodeManagerId, 9;
    setarray @npc_loc, 26, 37, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,348,30,0|script|#Node50|503,
{
    set @NodeId, 50;
    set @NodeManagerId, 9;
    setarray @npc_loc, 348, 30, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,404,112,0|script|#Node51|503,
{
    set @NodeId, 51;
    set @NodeManagerId, 9;
    setarray @npc_loc, 404, 112, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,164,111,0|script|#Node52|503,
{
    set @NodeId, 52;
    set @NodeManagerId, 9;
    setarray @npc_loc, 164, 111, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,279,75,0|script|#Node53|503,
{
    set @NodeId, 53;
    set @NodeManagerId, 9;
    setarray @npc_loc, 279, 75, 2;
    callfunc "TerraniteVein";
    end;
}

// Gather Node NPC
012-4.gat,293,175,0|script|#Node54|503,
{
    set @NodeId, 54;
    set @NodeManagerId, 9;
    setarray @npc_loc, 293, 175, 2;
    callfunc "TerraniteVein";
    end;
}
