// Mining Nodes
// Author: wushin
// NodeManager
031-1.gat,0,0,0|script|#NodeManager49|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFortynineSpawned, "", getarraysize($@NodesFortynineSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFortynineNodeLoop, 0;
    set $@RandomFortynineNode, rand(getarraysize($@NodeManagerFortynineSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFortynineNode == $@NodesFortynineSpawned[$@RandomFortynineNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFortynineNodeLoop, ($@RandomFortynineNodeLoop + 1);
    if ($@RandomFortynineNodeLoop >= getarraysize($@NodesFortynineSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFortynineSpawn[$@RandomFortynineNode];
    setarray $@NodesFortynineSpawned[$@NodeManagerFortynineSpawnCount], $@RandomFortynineNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFortynineSpawnCount, ($@NodeManagerFortynineSpawnCount + 1);
    if ($@NodeManagerFortynineSpawnMax > $@NodeManagerFortynineSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFortynineNodeLoop, 0;
    set $@RandomFortynineNode, rand(getarraysize($@NodeManagerFortynineSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFortynineNode == $@NodesFortynineSpawned[$@RandomFortynineNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFortynineNodeLoop, ($@RandomFortynineNodeLoop + 1);
    if ($@RandomFortynineNodeLoop >= getarraysize($@NodesFortynineSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFortynineSpawn[$@RandomFortynineNode];
    setarray $@NodesFortynineSpawned[$@DisableFortynineSpawnsLoop], $@RandomFortynineNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFortynineSpawnsLoop, ($@DisableFortynineSpawnsLoop + 1);
    if ($@NodeManagerFortynineSpawnMax > $@DisableFortynineSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFortynineSpawnCount, ($@NodeManagerFortynineSpawnCount - 1);
    if ($@NodeManagerFortynineSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFortynineSpawnsLoop, 0;
    set $@NodeManagerFortynineSpawnMax, 3;
    set $@NodeManagerFortynineSpawnCount, 3;
    setarray $@NodeManagerFortynineSpawn, 309, 310, 311, 312, 313, 314;
    cleararray $@NodesFortynineSpawned, "", getarraysize($@NodesFortynineSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
031-1.gat,80,113,0|script|#Node309|602,
{
    set @NodeId, 309;
    set @NodeManagerId, 49;
    setarray @npc_loc, 80, 113, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
031-1.gat,93,81,0|script|#Node310|602,
{
    set @NodeId, 310;
    set @NodeManagerId, 49;
    setarray @npc_loc, 93, 81, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
031-1.gat,75,60,0|script|#Node311|602,
{
    set @NodeId, 311;
    set @NodeManagerId, 49;
    setarray @npc_loc, 75, 60, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
031-1.gat,84,53,0|script|#Node312|602,
{
    set @NodeId, 312;
    set @NodeManagerId, 49;
    setarray @npc_loc, 84, 53, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
031-1.gat,69,37,0|script|#Node313|602,
{
    set @NodeId, 313;
    set @NodeManagerId, 49;
    setarray @npc_loc, 69, 37, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
031-1.gat,64,38,0|script|#Node314|602,
{
    set @NodeId, 314;
    set @NodeManagerId, 49;
    setarray @npc_loc, 64, 38, 2;
    callfunc "CobaltPlant";
    end;
}
// NodeManager
031-1.gat,0,0,0|script|#NodeManager50|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFiftySpawned, "", getarraysize($@NodesFiftySpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFiftyNodeLoop, 0;
    set $@RandomFiftyNode, rand(getarraysize($@NodeManagerFiftySpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFiftyNode == $@NodesFiftySpawned[$@RandomFiftyNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFiftyNodeLoop, ($@RandomFiftyNodeLoop + 1);
    if ($@RandomFiftyNodeLoop >= getarraysize($@NodesFiftySpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFiftySpawn[$@RandomFiftyNode];
    setarray $@NodesFiftySpawned[$@NodeManagerFiftySpawnCount], $@RandomFiftyNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFiftySpawnCount, ($@NodeManagerFiftySpawnCount + 1);
    if ($@NodeManagerFiftySpawnMax > $@NodeManagerFiftySpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFiftyNodeLoop, 0;
    set $@RandomFiftyNode, rand(getarraysize($@NodeManagerFiftySpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFiftyNode == $@NodesFiftySpawned[$@RandomFiftyNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFiftyNodeLoop, ($@RandomFiftyNodeLoop + 1);
    if ($@RandomFiftyNodeLoop >= getarraysize($@NodesFiftySpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFiftySpawn[$@RandomFiftyNode];
    setarray $@NodesFiftySpawned[$@DisableFiftySpawnsLoop], $@RandomFiftyNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFiftySpawnsLoop, ($@DisableFiftySpawnsLoop + 1);
    if ($@NodeManagerFiftySpawnMax > $@DisableFiftySpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFiftySpawnCount, ($@NodeManagerFiftySpawnCount - 1);
    if ($@NodeManagerFiftySpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFiftySpawnsLoop, 0;
    set $@NodeManagerFiftySpawnMax, 3;
    set $@NodeManagerFiftySpawnCount, 3;
    setarray $@NodeManagerFiftySpawn, 315, 316, 317, 318, 319, 320;
    cleararray $@NodesFiftySpawned, "", getarraysize($@NodesFiftySpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
031-1.gat,105,43,0|script|#Node315|609,
{
    set @NodeId, 315;
    set @NodeManagerId, 50;
    setarray @npc_loc, 105, 43, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
031-1.gat,99,118,0|script|#Node316|609,
{
    set @NodeId, 316;
    set @NodeManagerId, 50;
    setarray @npc_loc, 99, 118, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
031-1.gat,103,96,0|script|#Node317|609,
{
    set @NodeId, 317;
    set @NodeManagerId, 50;
    setarray @npc_loc, 103, 96, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
031-1.gat,105,90,0|script|#Node318|609,
{
    set @NodeId, 318;
    set @NodeManagerId, 50;
    setarray @npc_loc, 105, 90, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
031-1.gat,104,74,0|script|#Node319|609,
{
    set @NodeId, 319;
    set @NodeManagerId, 50;
    setarray @npc_loc, 104, 74, 2;
    callfunc "IceCube";
    end;
}
// Gather Node NPC
031-1.gat,98,58,0|script|#Node320|609,
{
    set @NodeId, 320;
    set @NodeManagerId, 50;
    setarray @npc_loc, 98, 58, 2;
    callfunc "IceCube";
    end;
}
