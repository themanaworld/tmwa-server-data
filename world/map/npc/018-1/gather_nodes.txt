// Mining Nodes
// Author: wushin

// NodeManager
018-1.gat,0,0,0|script|#NodeManager33|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesThritythreeSpawned, "", getarraysize($@NodesThritythreeSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomThritythreeNodeLoop, 0;
    set $@RandomThritythreeNode, rand(getarraysize($@NodeManagerThritythreeSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomThritythreeNode == $@NodesThritythreeSpawned[$@RandomThritythreeNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomThritythreeNodeLoop, ($@RandomThritythreeNodeLoop + 1);
    if ($@RandomThritythreeNodeLoop >= getarraysize($@NodesThritythreeSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerThritythreeSpawn[$@RandomThritythreeNode];
    setarray $@NodesThritythreeSpawned[$@NodeManagerThritythreeSpawnCount], $@RandomThritythreeNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerThritythreeSpawnCount, ($@NodeManagerThritythreeSpawnCount + 1);
    if ($@NodeManagerThritythreeSpawnMax > $@NodeManagerThritythreeSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomThritythreeNodeLoop, 0;
    set $@RandomThritythreeNode, rand(getarraysize($@NodeManagerThritythreeSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomThritythreeNode == $@NodesThritythreeSpawned[$@RandomThritythreeNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomThritythreeNodeLoop, ($@RandomThritythreeNodeLoop + 1);
    if ($@RandomThritythreeNodeLoop >= getarraysize($@NodesThritythreeSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerThritythreeSpawn[$@RandomThritythreeNode];
    setarray $@NodesThritythreeSpawned[$@DisableThritythreeSpawnsLoop], $@RandomThritythreeNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableThritythreeSpawnsLoop, ($@DisableThritythreeSpawnsLoop + 1);
    if ($@NodeManagerThritythreeSpawnMax > $@DisableThritythreeSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerThritythreeSpawnCount, ($@NodeManagerThritythreeSpawnCount - 1);
    if ($@NodeManagerThritythreeSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableThritythreeSpawnsLoop, 0;
    set $@NodeManagerThritythreeSpawnMax, 3;
    set $@NodeManagerThritythreeSpawnCount, 3;
    setarray $@NodeManagerThritythreeSpawn, 208, 209, 210, 211, 212, 213;
    cleararray $@NodesThritythreeSpawned, "", getarraysize($@NodesThritythreeSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// Gather Node NPC
018-1.gat,51,61,0|script|#Node208|601,
{
    set @NodeId, 208;
    set @NodeManagerId, 33;
    setarray @npc_loc, 51, 61, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
018-1.gat,140,64,0|script|#Node209|601,
{
    set @NodeId, 209;
    set @NodeManagerId, 33;
    setarray @npc_loc, 140, 64, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
018-1.gat,100,80,0|script|#Node210|601,
{
    set @NodeId, 210;
    set @NodeManagerId, 33;
    setarray @npc_loc, 100, 80, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
018-1.gat,121,15,0|script|#Node211|601,
{
    set @NodeId, 211;
    set @NodeManagerId, 33;
    setarray @npc_loc, 121, 15, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
018-1.gat,92,57,0|script|#Node212|601,
{
    set @NodeId, 212;
    set @NodeManagerId, 33;
    setarray @npc_loc, 92, 57, 2;
    callfunc "MauvePlant";
    end;
}

// Gather Node NPC
018-1.gat,35,73,0|script|#Node213|601,
{
    set @NodeId, 213;
    set @NodeManagerId, 33;
    setarray @npc_loc, 35, 73, 2;
    callfunc "MauvePlant";
    end;
}
