// Mining Nodes
// Author: wushin

// NodeManager
002-1.gat,0,0,0|script|#NodeManager18|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesEighteenSpawned, "", getarraysize($@NodesEighteenSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomEighteenNodeLoop, 0;
    set $@RandomEighteenNode, rand(getarraysize($@NodeManagerEighteenSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomEighteenNode == $@NodesEighteenSpawned[$@RandomEighteenNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomEighteenNodeLoop, ($@RandomEighteenNodeLoop + 1);
    if ($@RandomEighteenNodeLoop >= getarraysize($@NodesEighteenSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerEighteenSpawn[$@RandomEighteenNode];
    setarray $@NodesEighteenSpawned[$@NodeManagerEighteenSpawnCount], $@RandomEighteenNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerEighteenSpawnCount, ($@NodeManagerEighteenSpawnCount + 1);
    if ($@NodeManagerEighteenSpawnMax > $@NodeManagerEighteenSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomEighteenNodeLoop, 0;
    set $@RandomEighteenNode, rand(getarraysize($@NodeManagerEighteenSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomEighteenNode == $@NodesEighteenSpawned[$@RandomEighteenNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomEighteenNodeLoop, ($@RandomEighteenNodeLoop + 1);
    if ($@RandomEighteenNodeLoop >= getarraysize($@NodesEighteenSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerEighteenSpawn[$@RandomEighteenNode];
    setarray $@NodesEighteenSpawned[$@DisableEighteenSpawnsLoop], $@RandomEighteenNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableEighteenSpawnsLoop, ($@DisableEighteenSpawnsLoop + 1);
    if ($@NodeManagerEighteenSpawnMax > $@DisableEighteenSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerEighteenSpawnCount, ($@NodeManagerEighteenSpawnCount - 1);
    if ($@NodeManagerEighteenSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableEighteenSpawnsLoop, 0;
    set $@NodeManagerEighteenSpawnMax, 3;
    set $@NodeManagerEighteenSpawnCount, 3;
    setarray $@NodeManagerEighteenSpawn, 103, 104, 105, 106, 107, 108;
    cleararray $@NodesEighteenSpawned, "", getarraysize($@NodesEighteenSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// Gather Node NPC
002-1.gat,55,96,0|script|#Node103|607,
{
    set @NodeId, 103;
    set @NodeManagerId, 18;
    setarray @npc_loc, 55, 96, 2;
    callfunc "PricklyPear";
    end;
}

// Gather Node NPC
002-1.gat,98,86,0|script|#Node104|607,
{
    set @NodeId, 104;
    set @NodeManagerId, 18;
    setarray @npc_loc, 98, 86, 2;
    callfunc "PricklyPear";
    end;
}

// Gather Node NPC
002-1.gat,77,50,0|script|#Node105|607,
{
    set @NodeId, 105;
    set @NodeManagerId, 18;
    setarray @npc_loc, 77, 50, 2;
    callfunc "PricklyPear";
    end;
}

// Gather Node NPC
002-1.gat,73,40,0|script|#Node106|607,
{
    set @NodeId, 106;
    set @NodeManagerId, 18;
    setarray @npc_loc, 73, 40, 2;
    callfunc "PricklyPear";
    end;
}

// Gather Node NPC
002-1.gat,44,48,0|script|#Node107|607,
{
    set @NodeId, 107;
    set @NodeManagerId, 18;
    setarray @npc_loc, 44, 48, 2;
    callfunc "PricklyPear";
    end;
}

// Gather Node NPC
002-1.gat,32,60,0|script|#Node108|607,
{
    set @NodeId, 108;
    set @NodeManagerId, 18;
    setarray @npc_loc, 32, 60, 2;
    callfunc "PricklyPear";
    end;
}
// NodeManager
002-1.gat,0,0,0|script|#NodeManager60|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesSixtySpawned, "", getarraysize($@NodesSixtySpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomSixtyNodeLoop, 0;
    set $@RandomSixtyNode, rand(getarraysize($@NodeManagerSixtySpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomSixtyNode == $@NodesSixtySpawned[$@RandomSixtyNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomSixtyNodeLoop, ($@RandomSixtyNodeLoop + 1);
    if ($@RandomSixtyNodeLoop >= getarraysize($@NodesSixtySpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerSixtySpawn[$@RandomSixtyNode];
    setarray $@NodesSixtySpawned[$@NodeManagerSixtySpawnCount], $@RandomSixtyNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerSixtySpawnCount, ($@NodeManagerSixtySpawnCount + 1);
    if ($@NodeManagerSixtySpawnMax > $@NodeManagerSixtySpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomSixtyNodeLoop, 0;
    set $@RandomSixtyNode, rand(getarraysize($@NodeManagerSixtySpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomSixtyNode == $@NodesSixtySpawned[$@RandomSixtyNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomSixtyNodeLoop, ($@RandomSixtyNodeLoop + 1);
    if ($@RandomSixtyNodeLoop >= getarraysize($@NodesSixtySpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerSixtySpawn[$@RandomSixtyNode];
    setarray $@NodesSixtySpawned[$@DisableSixtySpawnsLoop], $@RandomSixtyNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableSixtySpawnsLoop, ($@DisableSixtySpawnsLoop + 1);
    if ($@NodeManagerSixtySpawnMax > $@DisableSixtySpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerSixtySpawnCount, ($@NodeManagerSixtySpawnCount - 1);
    if ($@NodeManagerSixtySpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableSixtySpawnsLoop, 0;
    set $@NodeManagerSixtySpawnMax, 3;
    set $@NodeManagerSixtySpawnCount, 3;
    setarray $@NodeManagerSixtySpawn, 393, 394, 395, 396, 397, 398;
    cleararray $@NodesSixtySpawned, "", getarraysize($@NodesSixtySpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
002-1.gat,103,103,0|script|#Node393|604,
{
    set @NodeId, 393;
    set @NodeManagerId, 60;
    setarray @npc_loc, 103, 103, 2;
    callfunc "AlizarinPlant";
    end;
}
// Gather Node NPC
002-1.gat,88,99,0|script|#Node394|604,
{
    set @NodeId, 394;
    set @NodeManagerId, 60;
    setarray @npc_loc, 88, 99, 2;
    callfunc "AlizarinPlant";
    end;
}
// Gather Node NPC
002-1.gat,17,98,0|script|#Node395|604,
{
    set @NodeId, 395;
    set @NodeManagerId, 60;
    setarray @npc_loc, 17, 98, 2;
    callfunc "AlizarinPlant";
    end;
}
// Gather Node NPC
002-1.gat,49,78,0|script|#Node396|604,
{
    set @NodeId, 396;
    set @NodeManagerId, 60;
    setarray @npc_loc, 49, 78, 2;
    callfunc "AlizarinPlant";
    end;
}
// Gather Node NPC
002-1.gat,79,56,0|script|#Node397|604,
{
    set @NodeId, 397;
    set @NodeManagerId, 60;
    setarray @npc_loc, 79, 56, 2;
    callfunc "AlizarinPlant";
    end;
}
// Gather Node NPC
002-1.gat,103,15,0|script|#Node398|604,
{
    set @NodeId, 398;
    set @NodeManagerId, 60;
    setarray @npc_loc, 103, 15, 2;
    callfunc "AlizarinPlant";
    end;
}
