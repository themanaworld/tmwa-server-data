// NodeManager
047-1.gat,0,0,0|script|#NodeManager58|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFiftyeightSpawned, "", getarraysize($@NodesFiftyeightSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFiftyeightNodeLoop, 0;
    set $@RandomFiftyeightNode, rand(getarraysize($@NodeManagerFiftyeightSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFiftyeightNode == $@NodesFiftyeightSpawned[$@RandomFiftyeightNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFiftyeightNodeLoop, ($@RandomFiftyeightNodeLoop + 1);
    if ($@RandomFiftyeightNodeLoop >= getarraysize($@NodesFiftyeightSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFiftyeightSpawn[$@RandomFiftyeightNode];
    setarray $@NodesFiftyeightSpawned[$@NodeManagerFiftyeightSpawnCount], $@RandomFiftyeightNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFiftyeightSpawnCount, ($@NodeManagerFiftyeightSpawnCount + 1);
    if ($@NodeManagerFiftyeightSpawnMax > $@NodeManagerFiftyeightSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFiftyeightNodeLoop, 0;
    set $@RandomFiftyeightNode, rand(getarraysize($@NodeManagerFiftyeightSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFiftyeightNode == $@NodesFiftyeightSpawned[$@RandomFiftyeightNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFiftyeightNodeLoop, ($@RandomFiftyeightNodeLoop + 1);
    if ($@RandomFiftyeightNodeLoop >= getarraysize($@NodesFiftyeightSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFiftyeightSpawn[$@RandomFiftyeightNode];
    setarray $@NodesFiftyeightSpawned[$@DisableFiftyeightSpawnsLoop], $@RandomFiftyeightNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFiftyeightSpawnsLoop, ($@DisableFiftyeightSpawnsLoop + 1);
    if ($@NodeManagerFiftyeightSpawnMax > $@DisableFiftyeightSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFiftyeightSpawnCount, ($@NodeManagerFiftyeightSpawnCount - 1);
    if ($@NodeManagerFiftyeightSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFiftyeightSpawnsLoop, 0;
    set $@NodeManagerFiftyeightSpawnMax, 3;
    set $@NodeManagerFiftyeightSpawnCount, 3;
    setarray $@NodeManagerFiftyeightSpawn, 381, 382, 383, 384, 385, 386;
    cleararray $@NodesFiftyeightSpawned, "", getarraysize($@NodesFiftyeightSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
047-1.gat,31,54,0|script|#Node381|602,
{
    set @NodeId, 381;
    set @NodeManagerId, 58;
    setarray @npc_loc, 31, 54, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
047-1.gat,37,60,0|script|#Node382|602,
{
    set @NodeId, 382;
    set @NodeManagerId, 58;
    setarray @npc_loc, 37, 60, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
047-1.gat,111,20,0|script|#Node383|602,
{
    set @NodeId, 383;
    set @NodeManagerId, 58;
    setarray @npc_loc, 111, 20, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
047-1.gat,121,34,0|script|#Node384|602,
{
    set @NodeId, 384;
    set @NodeManagerId, 58;
    setarray @npc_loc, 121, 34, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
047-1.gat,147,57,0|script|#Node385|602,
{
    set @NodeId, 385;
    set @NodeManagerId, 58;
    setarray @npc_loc, 147, 57, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
047-1.gat,102,52,0|script|#Node386|602,
{
    set @NodeId, 386;
    set @NodeManagerId, 58;
    setarray @npc_loc, 102, 52, 2;
    callfunc "CobaltPlant";
    end;
}
