// Mining Nodes
// Author: wushin

// NodeManager
011-4.gat,0,0,0|script|#NodeManager3|400,
{
    end;

OnTimer15000:
    stopnpctimer;
    cleararray $@NodesThreeSpawned, "", getarraysize($@NodesThreeSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomThreeNodeLoop, 0;
    set $@RandomThreeNode, rand(getarraysize($@NodeManagerThreeSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomThreeNode == $@NodesThreeSpawned[$@RandomThreeNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomThreeNodeLoop, ($@RandomThreeNodeLoop + 1);
    if ($@RandomThreeNodeLoop >= getarraysize($@NodesThreeSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerThreeSpawn[$@RandomThreeNode];
    setarray $@NodesThreeSpawned[$@NodeManagerThreeSpawnCount], $@RandomThreeNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerThreeSpawnCount, ($@NodeManagerThreeSpawnCount + 1);
    if ($@NodeManagerThreeSpawnMax > $@NodeManagerThreeSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomThreeNodeLoop, 0;
    set $@RandomThreeNode, rand(getarraysize($@NodeManagerThreeSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomThreeNode == $@NodesThreeSpawned[$@RandomThreeNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomThreeNodeLoop, ($@RandomThreeNodeLoop + 1);
    if ($@RandomThreeNodeLoop >= getarraysize($@NodesThreeSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerThreeSpawn[$@RandomThreeNode];
    setarray $@NodesThreeSpawned[$@DisableThreeSpawnsLoop], $@RandomThreeNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableThreeSpawnsLoop, ($@DisableThreeSpawnsLoop + 1);
    if ($@NodeManagerThreeSpawnMax > $@DisableThreeSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerThreeSpawnCount, ($@NodeManagerThreeSpawnCount - 1);
    if ($@NodeManagerThreeSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableThreeSpawnsLoop, 0;
    set $@NodeManagerThreeSpawnMax, 3;
    set $@NodeManagerThreeSpawnCount, 3;
    setarray $@NodeManagerThreeSpawn, 13, 14, 15, 16, 17, 18;
    cleararray $@NodesThreeSpawned, "", getarraysize($@NodesThreeSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// NodeManager
011-4.gat,0,0,0|script|#NodeManager4|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFourSpawned, "", getarraysize($@NodesFourSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFourNodeLoop, 0;
    set $@RandomFourNode, rand(getarraysize($@NodeManagerFourSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFourNode == $@NodesFourSpawned[$@RandomFourNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFourNodeLoop, ($@RandomFourNodeLoop + 1);
    if ($@RandomFourNodeLoop >= getarraysize($@NodesFourSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFourSpawn[$@RandomFourNode];
    setarray $@NodesFourSpawned[$@NodeManagerFourSpawnCount], $@RandomFourNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFourSpawnCount, ($@NodeManagerFourSpawnCount + 1);
    if ($@NodeManagerFourSpawnMax > $@NodeManagerFourSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFourNodeLoop, 0;
    set $@RandomFourNode, rand(getarraysize($@NodeManagerFourSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFourNode == $@NodesFourSpawned[$@RandomFourNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFourNodeLoop, ($@RandomFourNodeLoop + 1);
    if ($@RandomFourNodeLoop >= getarraysize($@NodesFourSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFourSpawn[$@RandomFourNode];
    setarray $@NodesFourSpawned[$@DisableFourSpawnsLoop], $@RandomFourNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFourSpawnsLoop, ($@DisableFourSpawnsLoop + 1);
    if ($@NodeManagerFourSpawnMax > $@DisableFourSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFourSpawnCount, ($@NodeManagerFourSpawnCount - 1);
    if ($@NodeManagerFourSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFourSpawnsLoop, 0;
    set $@NodeManagerFourSpawnMax, 3;
    set $@NodeManagerFourSpawnCount, 3;
    setarray $@NodeManagerFourSpawn, 19, 20, 21, 22, 23, 24;
    cleararray $@NodesFourSpawned, "", getarraysize($@NodesFourSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// Gather Node NPC
011-4.gat,9,55,0|script|#Node13|501,
{
    set @NodeId, 13;
    set @NodeManagerId, 3;
    setarray @npc_loc, 9, 55, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
011-4.gat,43,49,0|script|#Node14|501,
{
    set @NodeId, 14;
    set @NodeManagerId, 3;
    setarray @npc_loc, 43, 49, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
011-4.gat,16,117,0|script|#Node15|501,
{
    set @NodeId, 15;
    set @NodeManagerId, 3;
    setarray @npc_loc, 16, 117, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
011-4.gat,122,116,0|script|#Node16|501,
{
    set @NodeId, 16;
    set @NodeManagerId, 3;
    setarray @npc_loc, 122, 116, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
011-4.gat,110,56,0|script|#Node17|501,
{
    set @NodeId, 17;
    set @NodeManagerId, 3;
    setarray @npc_loc, 110, 56, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
011-4.gat,116,47,0|script|#Node18|501,
{
    set @NodeId, 18;
    set @NodeManagerId, 3;
    setarray @npc_loc, 116, 47, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
011-4.gat,30,73,0|script|#Node19|502,
{
    set @NodeId, 19;
    set @NodeManagerId, 4;
    setarray @npc_loc, 30, 73, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
011-4.gat,40,27,0|script|#Node20|502,
{
    set @NodeId, 20;
    set @NodeManagerId, 4;
    setarray @npc_loc, 40, 27, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
011-4.gat,84,70,0|script|#Node21|502,
{
    set @NodeId, 21;
    set @NodeManagerId, 4;
    setarray @npc_loc, 84, 70, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
011-4.gat,46,110,0|script|#Node22|502,
{
    set @NodeId, 22;
    set @NodeManagerId, 4;
    setarray @npc_loc, 46, 110, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
011-4.gat,122,25,0|script|#Node23|502,
{
    set @NodeId, 23;
    set @NodeManagerId, 4;
    setarray @npc_loc, 122, 25, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
011-4.gat,68,33,0|script|#Node24|502,
{
    set @NodeId, 24;
    set @NodeManagerId, 4;
    setarray @npc_loc, 68, 33, 2;
    callfunc "IronVein";
    end;
}
