// Mining Nodes
// Author: wushin

// NodeManager
019-1.gat,0,0,0|script|#NodeManager34|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesThrityfourSpawned, "", getarraysize($@NodesThrityfourSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomThrityfourNodeLoop, 0;
    set $@RandomThrityfourNode, rand(getarraysize($@NodeManagerThrityfourSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomThrityfourNode == $@NodesThrityfourSpawned[$@RandomThrityfourNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomThrityfourNodeLoop, ($@RandomThrityfourNodeLoop + 1);
    if ($@RandomThrityfourNodeLoop >= getarraysize($@NodesThrityfourSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerThrityfourSpawn[$@RandomThrityfourNode];
    setarray $@NodesThrityfourSpawned[$@NodeManagerThrityfourSpawnCount], $@RandomThrityfourNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerThrityfourSpawnCount, ($@NodeManagerThrityfourSpawnCount + 1);
    if ($@NodeManagerThrityfourSpawnMax > $@NodeManagerThrityfourSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomThrityfourNodeLoop, 0;
    set $@RandomThrityfourNode, rand(getarraysize($@NodeManagerThrityfourSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomThrityfourNode == $@NodesThrityfourSpawned[$@RandomThrityfourNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomThrityfourNodeLoop, ($@RandomThrityfourNodeLoop + 1);
    if ($@RandomThrityfourNodeLoop >= getarraysize($@NodesThrityfourSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerThrityfourSpawn[$@RandomThrityfourNode];
    setarray $@NodesThrityfourSpawned[$@DisableThrityfourSpawnsLoop], $@RandomThrityfourNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableThrityfourSpawnsLoop, ($@DisableThrityfourSpawnsLoop + 1);
    if ($@NodeManagerThrityfourSpawnMax > $@DisableThrityfourSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerThrityfourSpawnCount, ($@NodeManagerThrityfourSpawnCount - 1);
    if ($@NodeManagerThrityfourSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableThrityfourSpawnsLoop, 0;
    set $@NodeManagerThrityfourSpawnMax, 3;
    set $@NodeManagerThrityfourSpawnCount, 3;
    setarray $@NodeManagerThrityfourSpawn, 214, 215, 216, 217, 218, 219;
    cleararray $@NodesThrityfourSpawned, "", getarraysize($@NodesThrityfourSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// Gather Node NPC
019-1.gat,113,82,0|script|#Node214|609,
{
    set @NodeId, 214;
    set @NodeManagerId, 34;
    setarray @npc_loc, 113, 82, 2;
    callfunc "IceCube";
    end;
}

// Gather Node NPC
019-1.gat,107,92,0|script|#Node215|609,
{
    set @NodeId, 215;
    set @NodeManagerId, 34;
    setarray @npc_loc, 107, 92, 2;
    callfunc "IceCube";
    end;
}

// Gather Node NPC
019-1.gat,114,98,0|script|#Node216|609,
{
    set @NodeId, 216;
    set @NodeManagerId, 34;
    setarray @npc_loc, 114, 98, 2;
    callfunc "IceCube";
    end;
}

// Gather Node NPC
019-1.gat,31,26,0|script|#Node217|609,
{
    set @NodeId, 217;
    set @NodeManagerId, 34;
    setarray @npc_loc, 31, 26, 2;
    callfunc "IceCube";
    end;
}

// Gather Node NPC
019-1.gat,27,56,0|script|#Node218|609,
{
    set @NodeId, 218;
    set @NodeManagerId, 34;
    setarray @npc_loc, 27, 56, 2;
    callfunc "IceCube";
    end;
}

// Gather Node NPC
019-1.gat,23,77,0|script|#Node219|609,
{
    set @NodeId, 219;
    set @NodeManagerId, 34;
    setarray @npc_loc, 23, 77, 2;
    callfunc "IceCube";
    end;
}
// NodeManager
019-1.gat,0,0,0|script|#NodeManager46|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesFortysixSpawned, "", getarraysize($@NodesFortysixSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomFortysixNodeLoop, 0;
    set $@RandomFortysixNode, rand(getarraysize($@NodeManagerFortysixSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomFortysixNode == $@NodesFortysixSpawned[$@RandomFortysixNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomFortysixNodeLoop, ($@RandomFortysixNodeLoop + 1);
    if ($@RandomFortysixNodeLoop >= getarraysize($@NodesFortysixSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerFortysixSpawn[$@RandomFortysixNode];
    setarray $@NodesFortysixSpawned[$@NodeManagerFortysixSpawnCount], $@RandomFortysixNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerFortysixSpawnCount, ($@NodeManagerFortysixSpawnCount + 1);
    if ($@NodeManagerFortysixSpawnMax > $@NodeManagerFortysixSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomFortysixNodeLoop, 0;
    set $@RandomFortysixNode, rand(getarraysize($@NodeManagerFortysixSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomFortysixNode == $@NodesFortysixSpawned[$@RandomFortysixNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomFortysixNodeLoop, ($@RandomFortysixNodeLoop + 1);
    if ($@RandomFortysixNodeLoop >= getarraysize($@NodesFortysixSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerFortysixSpawn[$@RandomFortysixNode];
    setarray $@NodesFortysixSpawned[$@DisableFortysixSpawnsLoop], $@RandomFortysixNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableFortysixSpawnsLoop, ($@DisableFortysixSpawnsLoop + 1);
    if ($@NodeManagerFortysixSpawnMax > $@DisableFortysixSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerFortysixSpawnCount, ($@NodeManagerFortysixSpawnCount - 1);
    if ($@NodeManagerFortysixSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableFortysixSpawnsLoop, 0;
    set $@NodeManagerFortysixSpawnMax, 3;
    set $@NodeManagerFortysixSpawnCount, 3;
    setarray $@NodeManagerFortysixSpawn, 291, 292, 293, 294, 295, 296;
    cleararray $@NodesFortysixSpawned, "", getarraysize($@NodesFortysixSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}
// Gather Node NPC
019-1.gat,46,36,0|script|#Node291|602,
{
    set @NodeId, 291;
    set @NodeManagerId, 46;
    setarray @npc_loc, 46, 36, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
019-1.gat,50,37,0|script|#Node292|602,
{
    set @NodeId, 292;
    set @NodeManagerId, 46;
    setarray @npc_loc, 50, 37, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
019-1.gat,109,33,0|script|#Node293|602,
{
    set @NodeId, 293;
    set @NodeManagerId, 46;
    setarray @npc_loc, 109, 33, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
019-1.gat,115,41,0|script|#Node294|602,
{
    set @NodeId, 294;
    set @NodeManagerId, 46;
    setarray @npc_loc, 115, 41, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
019-1.gat,105,63,0|script|#Node295|602,
{
    set @NodeId, 295;
    set @NodeManagerId, 46;
    setarray @npc_loc, 105, 63, 2;
    callfunc "CobaltPlant";
    end;
}
// Gather Node NPC
019-1.gat,95,49,0|script|#Node296|602,
{
    set @NodeId, 296;
    set @NodeManagerId, 46;
    setarray @npc_loc, 95, 49, 2;
    callfunc "CobaltPlant";
    end;
}
