// Mining Nodes
// Author: wushin

// NodeManager
012-3.gat,0,0,0|script|#NodeManager6|400,
{
    end;

OnTimer15000:
    stopnpctimer;
    cleararray $@NodesSixSpawned, "", getarraysize($@NodesSixSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomSixNodeLoop, 0;
    set $@RandomSixNode, rand(getarraysize($@NodeManagerSixSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomSixNode == $@NodesSixSpawned[$@RandomSixNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomSixNodeLoop, ($@RandomSixNodeLoop + 1);
    if ($@RandomSixNodeLoop >= getarraysize($@NodesSixSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerSixSpawn[$@RandomSixNode];
    setarray $@NodesSixSpawned[$@NodeManagerSixSpawnCount], $@RandomSixNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerSixSpawnCount, ($@NodeManagerSixSpawnCount + 1);
    if ($@NodeManagerSixSpawnMax > $@NodeManagerSixSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomSixNodeLoop, 0;
    set $@RandomSixNode, rand(getarraysize($@NodeManagerSixSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomSixNode == $@NodesSixSpawned[$@RandomSixNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomSixNodeLoop, ($@RandomSixNodeLoop + 1);
    if ($@RandomSixNodeLoop >= getarraysize($@NodesSixSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerSixSpawn[$@RandomSixNode];
    setarray $@NodesSixSpawned[$@DisableSixSpawnsLoop], $@RandomSixNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableSixSpawnsLoop, ($@DisableSixSpawnsLoop + 1);
    if ($@NodeManagerSixSpawnMax > $@DisableSixSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerSixSpawnCount, ($@NodeManagerSixSpawnCount - 1);
    if ($@NodeManagerSixSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableSixSpawnsLoop, 0;
    set $@NodeManagerSixSpawnMax, 3;
    set $@NodeManagerSixSpawnCount, 3;
    setarray $@NodeManagerSixSpawn, 31, 32, 33, 34, 35, 36;
    cleararray $@NodesSixSpawned, "", getarraysize($@NodesSixSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// NodeManager
012-3.gat,0,0,0|script|#NodeManager7|400,
{
    end;

OnTimer25000:
    stopnpctimer;
    cleararray $@NodesSevenSpawned, "", getarraysize($@NodesSevenSpawned);
    goto L_EnableSpawns;

L_EnableSpawns:
    set $@RandomSevenNodeLoop, 0;
    set $@RandomSevenNode, rand(getarraysize($@NodeManagerSevenSpawn));
    goto L_CheckNotEnabled;

L_CheckNotEnabled:
    if ($@RandomSevenNode == $@NodesSevenSpawned[$@RandomSevenNodeLoop])
        goto L_EnableSpawns;
    goto L_CheckNotEnabledLoop;

L_CheckNotEnabledLoop:
    set $@RandomSevenNodeLoop, ($@RandomSevenNodeLoop + 1);
    if ($@RandomSevenNodeLoop >= getarraysize($@NodesSevenSpawned))
        goto L_Enable;
    goto L_CheckNotEnabled;

L_Enable:
    enablenpc "#Node"+$@NodeManagerSevenSpawn[$@RandomSevenNode];
    setarray $@NodesSevenSpawned[$@NodeManagerSevenSpawnCount], $@RandomSevenNode;
    goto L_EnableCheck;

L_EnableCheck:
    set $@NodeManagerSevenSpawnCount, ($@NodeManagerSevenSpawnCount + 1);
    if ($@NodeManagerSevenSpawnMax > $@NodeManagerSevenSpawnCount)
        goto L_EnableSpawns;
    goto L_End;
 
L_Start:
    initnpctimer;
    goto L_End;

L_DisableSpawns:
    set $@RandomSevenNodeLoop, 0;
    set $@RandomSevenNode, rand(getarraysize($@NodeManagerSevenSpawn));
    goto L_CheckNotDisabled;

L_CheckNotDisabled:
    if ($@RandomSevenNode == $@NodesSevenSpawned[$@RandomSevenNodeLoop])
        goto L_DisableSpawns;
    goto L_CheckNotDisabledLoop;

L_CheckNotDisabledLoop:
    set $@RandomSevenNodeLoop, ($@RandomSevenNodeLoop + 1);
    if ($@RandomSevenNodeLoop >= getarraysize($@NodesSevenSpawned))
        goto L_Disable;
    goto L_CheckNotDisabled;

L_Disable:
    disablenpc "#Node"+$@NodeManagerSevenSpawn[$@RandomSevenNode];
    setarray $@NodesSevenSpawned[$@DisableSevenSpawnsLoop], $@RandomSevenNode;
    goto L_DisableCheck;

L_DisableCheck:
    set $@DisableSevenSpawnsLoop, ($@DisableSevenSpawnsLoop + 1);
    if ($@NodeManagerSevenSpawnMax > $@DisableSevenSpawnsLoop)
        goto L_DisableSpawns;
    goto L_End;

OnCommandTally:
    set $@NodeManagerSevenSpawnCount, ($@NodeManagerSevenSpawnCount - 1);
    if ($@NodeManagerSevenSpawnCount)
        goto L_End;
    goto L_Start;

OnInit:
    set $@DisableSevenSpawnsLoop, 0;
    set $@NodeManagerSevenSpawnMax, 3;
    set $@NodeManagerSevenSpawnCount, 3;
    setarray $@NodeManagerSevenSpawn, 37, 38, 39, 40, 41, 42;
    cleararray $@NodesSevenSpawned, "", getarraysize($@NodesSevenSpawned);
    goto L_DisableSpawns;

L_End:
    end;
}

// Gather Node NPC
012-3.gat,155,180,0|script|#Node31|501,
{
    set @NodeId, 31;
    set @NodeManagerId, 6;
    setarray @npc_loc, 155, 180, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
012-3.gat,282,149,0|script|#Node32|501,
{
    set @NodeId, 32;
    set @NodeManagerId, 6;
    setarray @npc_loc, 282, 149, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
012-3.gat,259,30,0|script|#Node33|501,
{
    set @NodeId, 33;
    set @NodeManagerId, 6;
    setarray @npc_loc, 259, 30, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
012-3.gat,324,100,0|script|#Node34|501,
{
    set @NodeId, 34;
    set @NodeManagerId, 6;
    setarray @npc_loc, 324, 100, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
012-3.gat,481,103,0|script|#Node35|501,
{
    set @NodeId, 35;
    set @NodeManagerId, 6;
    setarray @npc_loc, 481, 103, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
012-3.gat,413,27,0|script|#Node36|501,
{
    set @NodeId, 36;
    set @NodeManagerId, 6;
    setarray @npc_loc, 413, 27, 2;
    callfunc "CoalVein";
    end;
}

// Gather Node NPC
012-3.gat,141,179,0|script|#Node37|502,
{
    set @NodeId, 37;
    set @NodeManagerId, 7;
    setarray @npc_loc, 141, 179, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
012-3.gat,217,177,0|script|#Node38|502,
{
    set @NodeId, 38;
    set @NodeManagerId, 7;
    setarray @npc_loc, 217, 177, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
012-3.gat,183,119,0|script|#Node39|502,
{
    set @NodeId, 39;
    set @NodeManagerId, 7;
    setarray @npc_loc, 183, 119, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
012-3.gat,355,76,0|script|#Node40|502,
{
    set @NodeId, 40;
    set @NodeManagerId, 7;
    setarray @npc_loc, 355, 76, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
012-3.gat,484,69,0|script|#Node41|502,
{
    set @NodeId, 41;
    set @NodeManagerId, 7;
    setarray @npc_loc, 484, 69, 2;
    callfunc "IronVein";
    end;
}

// Gather Node NPC
012-3.gat,331,21,0|script|#Node42|502,
{
    set @NodeId, 42;
    set @NodeManagerId, 7;
    setarray @npc_loc, 331, 21, 2;
    callfunc "IronVein";
    end;
}
